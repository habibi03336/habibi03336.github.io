---

title: Virtual DOM
date: 2022-2-15
categories:
    - WEB
tags:
    - TIL

---

`React.js`나 `Vue.js` 같은 프론트앤드 라이브러리의 큰 특징 중 하나는 Virtual DOM을 사용한다는 것이다. Virtual DOM이란 브라우져 랜더링의 대상이 되는 DOM이 아니라, `React.js`나 `Vue.js`가 메모리 상에서만 관리하는 DOM을 의미한다.  이렇게 하는 이유는 브라우져의 랜더링을 효율적으로 관리하기 위해서이다.

[👻 브라우져 랜더링이 어떻게 이루어지는 알고 싶을 때 읽으면 좋은 글](https://devcecy.com/%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%A0%8C%EB%8D%94%EB%A7%81-%EB%90%A0%EA%B9%8C/)

DOM API가 DOM 객체에 변화를 주면 랜더트리가 다시 만들어지고, 다시 랜더링이 일어난다. 랜덩링을 다시 하는 것은 꽤나 많은 계산이 필요한 작업이다. 따라서 DOM 객체가 변할 때 마다 많은 랜더링이 일어난다면 성능 상의 문제가 일어날 가능성이 크다. 

[👻 Virtual DOM을 쓰는 이유에 대한 핵심을 짚어주는 글](https://www.geeksforgeeks.org/reactjs-virtual-dom/)

`React.js`나 `vue.js`를 활용하면 랜더링이 많이 일어나서 성능에 문제가 생기는 것을 방지할 수 있다. 왜냐하면 이 툴들이 통해 랜더링을 효율적으로 제어하기 때문이다. 이 때 필요한 것이 Virtual DOM이다.이 툴들은 Virtual DOM을 관리하고 있다가 DOM에 변화를 주는 상황이 생기면 바뀌는 부분에 대해서만 브라우져에게 재랜더링을 요청한다. 이러한 방식을 통해 랜더링을 효율적으로 제어 할 수 있게 되는 것이다.

[👻 React가 Virutal DOM의 변화를 탐색하는 방법이 담긴 글](https://velog.io/@sbinha/React에서-Virtual-DOM)

그렇다면 변화가 있는 DOM 객체를 어떻게 탐색할까? 트리를 탐색하고 비교하는 일반적인 방법인 diff 알고리즘은 O(n^3)의 시간 복잡도를 갖는다. 즉 1000개의 엘리먼트를 비교하기 위해서는 10억번의 연산을 해야한다. 이는 매우 비효율적이다. 따라서 `React.js`의 경우는 두 가지 가정을 통한 O(n)의 휴리스틱 알고리즘을 활용한다. 이때 두 개의 가정 중 하나는, 엘리먼트 종류가 다르면 비교하지 않는 다는 것이고, 다른 하나는 sibling인 같은 엘리먼트에 대해서 key값을 부여하는 것이다. 리액트를 사용하다보면 list를 만들 때 key값을 부여하라는 에러가 뜨는 것이 바로 이런 이유에서 였다.

* 만약 1) element종류(태그) 자체가 바뀌어 버리면 `React.js`는 원래 있던 것이 없어지고 새로운 것이 생겼다고 판단하여 그 부분 전체를 다시 랜더링 한다.
* 만약 2) key가 주어지지 않으면 순서만 바뀌어도 `React.js`는 다른 element로 인식해 다시 랜더링한다.

